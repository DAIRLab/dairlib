rows: 3
cols: 3

#To compare against the model optimization, we need to change a few params.
#For(model, sample_index) = (1, 1), we need
#stride_length : 0.21
#double + single support duration : 0.418216

#To walk in place, you can simply change the parameters to
#stride_length : 0

### Directories for model files and data files
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models/"
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210328_3dlipm_all_files/"
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210416_3dlipm_grid_all_files/"
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210505_3dlipm_all_files/"
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210602_3dlipm/"                                                      # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20210602_3dlipm_swing_ft_cubic_spline/robot_1/"                               # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210612_3dlipm/"                                                      # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210702_lipm_limit_height/"                                           # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210709_3dlipm_bigger_task_range/"                                    # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210802_3dlipm_bigger_range_bigger_mu/"                               # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210819_3dlipm_accel_as_regularization/"                              # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210825_3dlipm_varying_height/"                                       # rom_option 4
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20210918_3dlipm_fix_xy_part/"                                          # rom_option 9
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211013_3dlipm_fix_xy_and_forward_task/"                              # rom_option 9
############# From 2021/10/13 until 2021/12/20, the models that's supposed to use pelvis didn't use pelvis during model optimization stage ##############
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211013_3dlipm_fix_xy_and_only_stance_leg_joints/"                    # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211018_3dlipm_fix_xy_no_height_constraint/"                          # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211020_3dlipm_fix_xyz_and_only_stance_leg_joints/"                   # rom_option 11
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211109_3dlipm_fix_xy_and_degree_4_dyn/"                              # rom_option 12
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211124_3dlipm_fix_xy_and_dg_4_dyn_and_big_range/"                    # rom_option 12
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211213_3dlipm_fix_xy_big_w_vel_and_grad_main_cost/"                  # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211213_3dlipm_fix_xy_big_w_accel_and_grad_main_cost/"                # rom_option 10
#########################################################################################################################################################
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211221_3dlipm_fix_xy_big_w_vel_and_grad_main_cost/"                  # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211221_3dlipm_fix_xy_big_w_accel_and_grad_main_cost/"                # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211227_3dlipm_fix_xy_big_w_accel_and_grad_main_cost_and_big_range/"  # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211229_3dlipm_fix_xy_big_w_vel_and_grad_main_cost_and_big_range/"    # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20211229_3dlipm_fix_xy_big_w_vel_and_grad_main_cost_and_big_range_rerun_fix_task/"     # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20220105_big_accel_weight_and_grad_main_cost_and_big_range_0_pelvis_omega/"            # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20220108_big_vel_weight_and_grad_main_cost_and_big_range_0_pelvis_omega/"              # rom_option 10
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20220119_fix_xy__big_vel_weight__big_range__high_order/"               # rom_option 14
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_2021xxxx_3dlipm_fix_xyz_and_degree_4_dyn/"                             # rom_option 13
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20220131_rom17_much_smaller_range__only_walking_forward__more_forward/"                # rom_option 17
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20220131_rom17_smaller_range__only_walking_forward/"                   # rom_option 17
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/models_20220208_reeval_this_with_big_task--20220131_rom17_much_smaller_range__only_walking_forward__more_forward/"                  # rom_option 17
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220316_rom24_big_range/robot_1/"                                            # rom_option 24
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220406_rom28_big_range_big_vel_weight/robot_1/"                             # rom_option 28
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220406_rom29_big_range_big_vel_weight/robot_1/"                             # rom_option 29
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220323_rom27_big_range_bigger_step_size_5e-3/robot_1/"                      # rom_option 27
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220417_rom27_big_range_bigger_step_size_6e-3_torque_weight_dominate/robot_1/"                      # rom_option 27
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220511_explore_task_boundary_2D--20220417_rom27_big_torque/robot_1/"        # rom_option 27
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220422_rom30_bigger_footspread/robot_1/"                                    # rom_option 30
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20220510_rom27_big_range_bigger_step_size_5e-3_torque_weight_dominate_com_center/robot_1/"    # rom_option 27
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/testing_rl_20220422_rom30_bigger_footspread/robot_1/"                                    # rom_option 30
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20230427_4kg_toe_with_task_range/robot_1/"                                    # rom_option 27
#dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20230507_various_turning_and_stride_length__smaller_range/robot_1/"                                    # rom_option 27
dir_model: "../dairlib_data/goldilocks_models/planning/robot_1/20230530_two_task_planes__sl_gi_and_sl_tr/robot_1/"                                    # rom_option 27
dir_data: "../dairlib_data/goldilocks_models/planning/robot_1/data/"

### ROM parameter
rom_option: 27  # 4, 9
#The iteration number of the theta that you use.has to be >= 1
model_iter: 1 #150  #1 #30
#The sample that we use to initialize planner
sample_idx: 40 #19 #58 for 117 (9x13)   #40 for 81 (3x27)


###
use_hybrid_rom_mpc: true
lightweight_lcm_log: false

# Heuristics
vel_command_offset_x: 0.  #0.1  # hack: help rom_iter=300 walk in place at start

### High-level command (for both planner and controller)
global_target_position_x: 100000
global_target_position_y: 0

set_constant_walking_speed: false
constant_step_length_x: 0
constant_step_length_y: 0

set_constant_turning_rate: false
constant_turning_rate: 0

# when use_radio=true, the above high level command parameters are discarded
use_radio: false
use_virtual_radio: true  # use xbox controller in the simulation
vel_scale_rot: -0.5
vel_scale_trans_sagital: 0.6  # For some reason, Cassie in mujoco walks much faster than desired vel
vel_scale_trans_lateral: -0.2

# Pelvis height task (primarily used for sim cost eval)
# Note: This pelvis height is not use in the default swing foot planner (i.e. when we don't use the foot step from the planner).
#       The "pelvis height" for the default swing foot planner is set by the parameter below (lipm_height)
pelvis_height: -1.0 #-1.0
pelvis_com_height_diff_heuristic: 0.06  # 0.06 is a rough guess


### For both planner and controller
# Finite state machine states
left_support: 0
right_support: 1
double_support: 2
post_left_double_support: 3
post_right_double_support: 4

# Decrease single_support_duration when using "LIPM MPC + IK" for planner helps
left_support_duration: 0.35 #0.3   # 0.23 # 0.35 # 0.4
right_support_duration: 0.35 #0.3  # 0.23 # 0.35 # 0.4
double_support_duration: 0.0 #0.02


### For planner only

constant_rom_vel_during_double_support: false

# Parameters that affect the foot spread
y_vel_offset: 0.2  # 0.1  # during normal walking, y_vel is about 0.1 to 0.2 m/s
                   # 20221109 (hybird rom mpc): snopt doesn't respond to this parameter much, while ipopt responds reallyl well.
# `constant_rom_vel_during_double_support` also affects
# the "nominal FOM hip roll position" and cost weight also affect

# max_foot_speed should be more than two times bigger than the desired walking speed.
# (maybe leave at least 0.5m/s margin for it to catch up with the body when falling forward)
max_foot_speed: 4.5 #6 #3 # used to restrict swing foot travel distance
# max_step_length restricts the distance between stance and swing foot (not from pelvis to swing foot!).
# It cannot be too big. Otherwise, the ROM is not a good approximation to FOM
max_step_length: 0.9  #1.3  #0.9 # 0.7
# (step length is measured from stance foot to swing foot)
# desired body speed = desired_step_length / one stride duration
max_desired_step_length: 0.7  #0.9 #0.7 # 0.4
max_lipm_step_length: 0.8
#n_step : 2 #TODO : add this later for convenience

back_limit_wrt_pelvis: -0.6   # -0.5
front_limit_wrt_pelvis: 0.6   # 0.5
right_limit_wrt_pelvis: 0.02  #0.02 # 0.06  # This cannot be too big if we want to get desired pose as close to FOM trajopt's as possible (used in planner's regularization cost)
left_limit_wrt_pelvis: 0.5    # 0.4
right_limit_wrt_stance_ft: 0.02  #0.02 # 0.06  # This cannot be too big if we want to get desired pose as close to FOM trajopt's as possible (used in planner's regularization cost)

### Planner cost weight
use_lipm_mpc_and_ik: false

# Hybrid ROM MPC
w_Q: 0
w_R: 0
w_rom_reg: 1e-6  # reminder: should have at least a little bit of reg cost
w_reg_xy: 0.1  # setting to 0 seems to provide better tracking of desired vel (doesn't diverge)
w_reg_xy_vel: 0.4  #0.4  # 0.1 is too small for y tracking (to achieve desired foot spread)
w_predict_lipm_p: .1
w_predict_lipm_v: 0.4
# Below is not used for hybrid ROM MPC
w_reg_quat: 0
w_reg_z: 0
w_reg_joints: 0
w_reg_hip_yaw: 0
w_reg_vel: 0

# Without LIPM MPC and IK
#w_Q: 0           # I removed this because we have state regularization
#w_R: 2e-6
#w_rom_reg: 1e-6  # reminder: should have at least a little bit of reg cost
#w_reg_quat: 1
#w_reg_xy: 0.1  #0.1 for not using IK; maybe 10 for using IK?
#w_reg_z: 50  # 10
#w_reg_joints: 0.02
#w_reg_hip_yaw: 1  # should use 1? 5?
#w_reg_xy_vel: 0.1
#w_reg_vel: 1e-6
#w_predict_lipm_p: .1
#w_predict_lipm_v: 0.01

# With LIPM MPC and IK
#w_Q: 0.01
#w_R: 2e-6
#w_rom_reg: 0  #1e-6  # reminder: should have at least a little bit of reg cost
#w_reg_quat: 1
#w_reg_xy: 10  #0.1 for not using IK; maybe 10 for using IK?
#w_reg_z: 50  # 10
#w_reg_joints: 0.1
#w_reg_hip_yaw: 1  # should use 1? 5?
#w_reg_xy_vel: 0.1
#w_reg_vel: 1e-6
#w_predict_lipm_p: .1
#w_predict_lipm_v: 0.01

# Testing -- With LIPM MPC and IK (high joint cost)
#w_Q: 0.01
#w_R: 2e-6
#w_rom_reg: 0  #1e-6  # reminder: should have at least a little bit of reg cost
#w_reg_quat: 10
#w_reg_xy: 1e-2  #0.1 for not using IK; maybe 10 for using IK?
#w_reg_z: 1e-2  # 10
#w_reg_joints: 0.1
#w_reg_hip_yaw: 1  # should use 1? 5?
#w_reg_xy_vel: 10  # 0.1
#w_reg_vel: 1e-6
#w_predict_lipm_p: .1
#w_predict_lipm_v: 0.01

# lipm mpc
max_speed_lipm_mpc: 1.0  # too big would cause instability to FOM planner  # TODO: not yet implemented
w_p_lipm_mpc: 0.01
w_v_lipm_mpc: 0.1


### For controller only

# TrackingDataSettings
relative_swing_ft: true

# Swing foot tracking heurisitcs for spring model
swing_foot_target_offset_x: -0.0197 #-0.01
                                   # -0.0197 is the diff between toe mid contact and toe origin
                                   # Note that we only use this when relative_swing_ft is true because it's in local frame
                                   # Also, this is probably necessary for hybrid rom MPC

# Swing foot heuristics for the hardware (there is asymmetry in the legs; the right foot sometimes hovers above the ground and then stomps)
final_foot_height_offset_for_right_leg: -0.02

#High level command gains(without radio)
yaw_deadband_blur: 5
yaw_deadband_radius: 5  # intentionally made this big to not track pelvis yaw

kp_yaw: 1
kd_yaw: 0.2
vel_max_yaw: 0.5

kp_pos_sagital: 0 # 0.1 #1.0
kd_pos_sagital: 0 # 0.01 #0.2
vel_max_sagital: 0 # 0.25
kp_pos_lateral: 0 # 0.1 #0.5
kd_pos_lateral: 0 # 0.01 #0.1
vel_max_lateral: 0 # 0.15
target_pos_offset: 0 # -0.16

#Speed control gains
k_ff_sagittal: 0
k_fb_sagittal: 0.2
k_ff_lateral: 0
k_fb_lateral: 0.15
speed_control_offset_sagittal: -0.0  # -0.04 for hardware; -0.01 for drake with springs; -0.0 for mujoco with springs

#Finite state machine
ss_time: 0.
ds_time: 0.

#Swing foot trajectory
max_CoM_to_footstep_dist: 0.5
footstep_offset: 0.0
center_line_offset: 0.03
mid_foot_height: 0.05  #0.03   # The robot sometimes cannot catch itself when this foot height is small (e.g. 5cm)
final_foot_height: -0.0
final_foot_velocity_z: 0.0

#LIPM trajectory
lipm_height: 0.9  # only used for the default footstep planner


### For IK controller (testing)
kp_hip_roll_stance: 200  #400
kp_hip_yaw_stance: 100  #200
kp_hip_pitch_stance: 200  #500
kp_knee_stance: 200  #500
kp_toe_stance: 5  #10

kd_hip_roll_stance: 5  #10
kd_hip_yaw_stance: 2  #4
kd_hip_pitch_stance: 7  #15
kd_knee_stance: 7  #15
kd_toe_stance: 1  #2

kp_hip_roll_swing: 50  #100
kp_hip_yaw_swing: 100  #200
kp_hip_pitch_swing: 50  #100
kp_knee_swing: 100  #200
kp_toe_swing: 5  #10

kd_hip_roll_swing: 10  #20
kd_hip_yaw_swing: 2  #4
kd_hip_pitch_swing: 10  #20
kd_knee_swing: 7  #15
kd_toe_swing: 1  #2
